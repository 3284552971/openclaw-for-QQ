# ===== 群聊白名单 =====
# 为空时表示所有群可用；非空时仅这些群可触发 openclaw
group_pool:
  - 1000000003

# ===== 次数限流（群聊非 root 用户）=====
# window_seconds: 统计窗口（秒）
# max_questions: 窗口内最多提问次数；0 表示关闭限制
rate_limit:
  window_seconds: 0
  max_questions: 0

# ===== Token 限流（群聊非 root 用户）=====
# max_tokens: 窗口内累计 token 上限；0 表示关闭限制
token_limit:
  window_seconds: 0
  max_tokens: 0

# ===== Root 用户列表 =====
# 用于私聊直通、群模式管理等高权限逻辑
root_ids:
  - 1000000001

# ===== 图片目录监听（可选）=====
# 若开启，会扫描目录中新图片并自动发送
image_watch:
  enabled: false
  root_dir: data/imagedata
  poll_seconds: 2

# ===== 远程 OpenClaw 网关配置 =====
# invoke_mode=remote 时使用
remote:
  host: 127.0.0.1
  port: 18789
  token: "CHANGE_ME_OPENCLAW_TOKEN"
  timeout_seconds: 120

# ===== 运行模式 =====
# invoke_mode:
# - auto: 优先 CLI，找不到 CLI 时回退 remote
# - cli: 强制本地命令行调用
# - remote: 强制远程网关调用
# cli_stateless=true 时每次请求都使用新会话（更“单轮”）
# session_backend:
# - sessions_send: 通过 gateway 的 sessions_send 调用（推荐，前端会话可见）
# - agent_cli: 直接走 openclaw agent --session-id
# gateway_fallback_policy（仅 session_backend=sessions_send 时生效）:
# - retry_then_cli: sessions_send 失败后回退 CLI
# - error_only: 不回退，直接报错
# - direct_cli: 直接走 CLI（跳过 sessions_send）
runtime:
  invoke_mode: cli
  cli_cmd: openclaw
  # CLI 兜底时使用的 agent 名称（openclaw agent --agent <name>）
  cli_agent: main
  cli_timeout_seconds: 180
  cli_stateless: false
  session_backend: sessions_send
  gateway_fallback_policy: retry_then_cli
  gateway_retry_count: 3
  gateway_retry_delay_seconds: 1.0

# ===== 本地桥接 HTTP 服务 =====
# 由插件进程提供，开启后会监听本机端口供 OpenClaw 调用
bridge:
  enabled: true
  host: 127.0.0.1
  port: 18999
  token: "CHANGE_ME_BRIDGE_TOKEN"
  # 允许桥接读写的根目录（建议使用相对路径）
  allowed_paths:
    - ./data

# ===== 上下文缓存 =====
# 控制最近消息缓存规模，以及注入到 prompt 的窗口大小
context:
  enabled: true
  max_messages_per_channel: 300
  default_recent_limit: 20
  default_recent_max_chars: 4000
  prompt_recent_limit: 12
  prompt_recent_max_chars: 1500

# ===== 图片工具配置 =====
image_tool:
  download_root: data/downloads/images
  download_timeout_seconds: 30
  download_max_mb: 20
  read_allow_base64: false
  read_max_base64_chars: 200000

# ===== 文件工具配置 =====
file_tool:
  download_root: data/downloads/files
  download_timeout_seconds: 60
  download_max_mb: 50

# ===== 回落发送策略 =====
# 当模型未通过桥接主动发送消息时，是否由插件自动把 reply 发回 QQ
delivery:
  fallback_send_reply: true
  # 忽略 JSON 样式回复，避免把工具结果原样刷屏
  ignore_json_reply: true
